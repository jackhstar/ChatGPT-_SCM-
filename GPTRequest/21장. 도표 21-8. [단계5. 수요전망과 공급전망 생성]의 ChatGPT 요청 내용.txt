# **(단계 5)**
1)	데이터 형식 및 일관성 유지:
모든 데이터의 YYYYMM 필드는 "YYYY-MM"의 문자형으로 저장 및 유지합니다. 이 필드를 사용하여 데이터 병합 시 키(key)로 활용하며, 데이터의 형식 일관성을 확인합니다.
2)	새 지표 정의 및 계산:
	수요전망 (DEMAND_FORECAST): 중국 수출량(CH_EXP)을 기반으로 하며, 해당 월부터 다음 분기의 마지막 월까지의 데이터를 사용하여 단순 평균으로 계산합니다.
2-1) 분기 정의:
1분기: 1월, 2월, 3월, 2분기: 4월, 5월, 6월, 3분기: 7월, 8월, 9월, 4분기: 10월, 11월, 12월
2-2) 계산 규칙:
각 월에 대해 해당 월을 포함하고 다음 분기의 마지막 월까지 데이터를 사용합니다.
예를 들어, 2월의 데이터를 계산할 때는 2월부터 다음 분기인 2분기의 마지막인 6월까지의 데이터를 사용하여 평균을 산출합니다.


-	분기의 끝에 해당하는 월(9월, 10월, 11월)의 계산: 해당 연도의 다음 분기 데이터가 부족하거나 없는 경우, 다음 해의 1사분기 데이터를 사용합니다. 예를 들어, 2014년 10월과 11월의 데이터를 계산할 때는 2015년 1사분기 데이터를 사용합니다.
-	데이터 세트의 끝부분에 해당하는 월(2023년 1월, 2월, 3월)의 계산: 다음 분기의 데이터가 전혀 없는 경우, 해당 연도의 남은 분기 데이터만을 사용합니다. 예를 들어, 2023년 1월, 2월, 3월은 2023년 1사분기 데이터만 사용하여 평균을 계산합니다.
2-3) 데이터 사용:
각 월별로 실적 및 전망 데이터가 합쳐진 칼럼에서 필요한 데이터를 추출합니다.
실적 데이터는 2021년 9월 이전, 전망 데이터는 2021년 10월 이후의 데이터를 포함합니다.
2-4) 에러 방지:
각 계산 전, 해당 월의 데이터가 전체 기간 동안 존재하는지 확인합니다. 데이터 누락이나 업데이트가 발생하지 않도록 주의합니다.
	공급전망 (SUPPLY_FORECAST): 명목선복량(FLEET_DEV)을 참조하여 같은 방식으로 계산합니다.
3)	수요전망과 공급전망의 통합 확인:
수요전망과 공급전망 필드가 2014년 1월부터 2023년 3월까지 하나의 필드로 구성하고 결측치가 없는지 확인한다.
4)	데이터 병합 및 검증:
4단계.xlsx 파일을 기본 테이블로 설정하고, 수요전망 및 공급전망 데이터를 해당 파일에 왼쪽 병합(left join)하여 추가합니다.
병합 과정에서 실적 및 예측 데이터가 올바르게 결합되었는지, 특히 YYYYMM 필드의 형식이 일관되게 유지되었는지 확인합니다.
2021년 10월 이후의 전망치와 관련된 모든 데이터가 정확히 병합되었는지 검증합니다.
5)	수요전망 및 공급전망의 검증:
예를 들어, 2014년 2월의 수요전망과 공급전망 값을 계산하고, 이들 값이 각각 17,326,326 및 17,547,251인지 확인합니다.
6)	결측치 검사 및 진행 확인:
갱신된 MART 테이블에서 결측치 및 2014년 2월의 수요전망 17,326,326을 확인한 후, 사용자에게 진행 여부를 문의합니다.
7)	데이터 시각화:
수요전망과 공급전망 데이터를 기반으로 한 월별 추이를 나타내는 2개의 꺾은선 그래프를 생성합니다. X축에는 2014년 1월부터 년도("2014")만 표시하고, 그래프는 영문으로 작성하여 언어 깨짐을 방지합니다.